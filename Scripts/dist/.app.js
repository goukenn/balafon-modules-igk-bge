(()=>{var __webpack_exports__={};(function(){var _iniR=0,_scriptLoc=igk.getScriptLocation(),_lang=igk.dom.html().getAttribute("lang")||igk.navigator.getLang(),loc=igk.getScriptLocation();function _getBufferBit(e,t){if(igk.isUndef(typeof t))return e.COLOR_BUFFER_BIT|e.DEPTH_BUFFER_BIT;o=0;for(var i=0;i<t.length;i++)t[i]in e&&(o|=e[t[i]]);return o}function __unloadSurface(e){return function(){e.dispose()}}igk.system.createNS("igk.bge.R",{}),igk.system.createNS("igk.bge.events",{});var _clGameObj=null;function BgeGameSurface(mainScript,options){_clGameObj=igk.bge.gameObjects;try{eval(mainScript)}catch(e){return void console.error("main.js script evaluation failed: "+e.message)}var __primaryFunc={clearScene:function(){gl.clearColor(bgColor.r,bgColor.g,bgColor.b,bgColor.a),gl.clear(clearBit)},update:function(){},render:function(){}};for(var i in $igk(options.canvas).on("dbltouch click dblclick",(function(e){var t=$igk(document);if(!t.isFullScreen&&t.fullscreenElement!=options.canvas&&(/(dbltouch)/.test(e.type)&&(options.dbltouch=1),"dblclick"==e.type||options.dbltouch&&"click"==e.type)){var i=$igk(options.canvas),n=igk.fn.getItemFunc(i.o,"requestFullScreen");n&&n.apply(i.o),options.dbltouch=0}})),__primaryFunc)"undefined"==eval("typeof("+i+")")&&eval("var "+i+"= __primaryFunc[i];");var gamepause=!1,gl=options.glContext,bgColor=options.info.profile.sceneBackgroundColor||{r:0,g:0,b:0,a:1},clearBit=_getBufferBit(gl,options.info.sceneBufferBit),surface=this;igk.defineProperty(this,"gl",{get:function(){return gl}});var shader=options.uriBase+"/shaders",_shadersl=options.info.shaders||[];this.shaders={},this.canvas=options.canvas;var _c=igk.createNode("event"),_e={};function _updateSize(){var e=$igk(options.canvas);e.o.width=igk.getNumber(e.getComputedStyle("width")),e.o.height=igk.getNumber(e.getComputedStyle("height"))}function chainLoader(e){var t=0,i=new igk.system.Promise;function n(o,a){if(t>=e.length)i.resolve();else{var r=shader+"/"+[e[t]];igk.system.io.getData(r,(function(i){var n=e[t],o=n.indexOf(".",-1);n=n.substring(0,o)+n.substring(o+1).toUpperCase(),surface.shaders[n]=i.data})).then((function(e){n(++t,a)})).error((function(e){console.debug("failed to load "+r)}))}}return igk.invokeAsync((function(){n(0,n)})),i}_c.addEvent("sizeChanged",_e),this.on=function(e,t){_c.reg_event(e,t)},igk.winui.reg_event(window,"resize",(function(){_updateSize(),igk.winui.events.raise(_c,"sizeChanged",{item:surface})})),_updateSize();var _gameStart=Date.now(),_gameTime=0,_initialize=0;function Tick(){return update(),render(),1}function TickTime(){return Tick(_gameTime=Date.now()-_gameStart)}function Initializing(){return _initialize?0:(clearScene(),1)}chainLoader(_shadersl).then((function(){try{initialize()}catch(e){return void console.error("failed to initialize: "+e.message)}_initialize=1,igk.html5.animate(Tick)})),igk.html5.animate(Initializing)}function __initSurface(){var e=this.add("canvas"),t=this.getAttribute("bge:uribase"),i=igk.html5.createWebGLContext(e.o),n=null;i?(igk.dom.body().on("unload",__unloadSurface(i)),null!=t&&igk.system.io.getData(t+"/.bge.json",(function(e){var t=igk.JSON.parse(e.data);n=t})).then((function(){n&&igk.system.io.getData(t+"/main.js",(function(o){igk.invokeAsync((function(){new BgeGameSurface(o.data,{uriBase:t,canvas:e.o,glContext:i,info:n})}))}))})).error((function(){console.debug("failed to load game setting")}))):igk.log.write(igk.bge.R.err_context_failed)}igk.winui.initClassControl("igk-bge-game-surface",__initSurface)})(),function(){const e=igk.system.createNS("igk.bge.webgl",{webgl_surface(e){let t=e.gl,i={backgroundColor:[1,0,1,1],clearBit:e.clearBit||t.COLOR_BUFFER_BIT},n=0,o=0,a=0;return t.clearColor(i.backgroundColor[0],i.backgroundColor[1],i.backgroundColor[2],i.backgroundColor[3]),{toString:()=>"webGLApp",clear(){t.clear(i.clearBit)},updateFrame(){},animFrame(){let e=this;o||(e.clear(),e.render(t),e.flush(),window.requestAnimationFrame((()=>e.animFrame())))},flush(){t.flush()},run(){let e=this;e.created(),n=setInterval((()=>e.updateFrame()),66),window.requestAnimationFrame((()=>e.animFrame()))},pause(){o=!o,o?n&&(clearInterval(n),n=0):this.run()},tick:function(){},updateTick:function(){},render:function(){console.log("render----")},created:function(){if(a)return;let t=this;$igk(e.target).on("click",(function(){t.pause()})),a=!0}}},createContext:(e,t)=>e.getContext("webgl",t)||e.getContext("experimental-webgl",t)});igk.winui.initClassControl("igk-webgl-surface",(function(){const{webgl_surface:t,createContext:i}=e;let n=this.add("canvas"),o={alpha:!0,enableDebug:!1,antialias:!0};n.setAttribute("width",300),n.setAttribute("height",300),n.o.style="background-color:red;";let a=i(n.o,o);if(!a)return this.remove(),void console.log("failed to create webgl context");console.log("web context created"),t({gl:a,target:n.o,options:o}).run()}))}()})();